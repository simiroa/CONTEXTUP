# Noise Master 코드 리뷰 보고서

## 개요

Noise Master 기능의 코드를 리뷰한 결과, 기능 오작동을 유발하는 심각한 버그와 사용자 경험을 저해하는 사소한 문제를 발견했습니다. 전반적인 코드 구조는 현대적이고 잘 설계되었으나, 렌더링 로직의 핵심적인 부분에서 논리적 오류가 확인되었습니다.

## 주요 문제: 잘못된 프레임버퍼 초기화

**위치:** `ContextUp/src/features/tools/noise_master/logic/renderer.py`

**설명:**
레이어 스택을 렌더링할 때, 첫 번째 프레임버퍼(FBO)를 **불투명한 검은색(0, 0, 0, 1)**으로 초기화하고 있습니다.

```python
# logic/renderer.py -> render_to_texture 메소드
def render_to_texture(...):
    ...
    self.fbo_a.use()
    self.fbo_a.clear(0.0, 0.0, 0.0, 1.0)  # <-- 문제의 코드
    prev_tex = self.tex_a
    ...
```

다중 레이어를 합성하는 그래픽스 파이프라인에서는, 첫 레이어가 그려지기 전의 배경이 **완전히 투명한 검은색(0, 0, 0, 0)**이어야 합니다. 그렇지 않으면 첫 번째 레이어의 블렌딩 연산(투명도 포함)이 불투명한 검은색을 대상으로 수행되어 예상과 다른 결과를 낳게 됩니다.

**사용자에게 미치는 영향:**

*   **Multiply 블렌드 모드 오작동:** 첫 레이어의 블렌드 모드를 'Multiply'로 설정하면, 결과물이 항상 검은색으로 나옵니다.
*   **Overlay, Add 등 기타 블렌드 모드 왜곡:** 'Overlay' 같은 다른 블렌드 모드들도 검은색 배경과 혼합되면서 의도보다 어둡게 표현됩니다.
*   **첫 레이어 투명도 문제:** 첫 번째 레이어의 투명도(Opacity)를 조절하면, 투명해지는 것이 아니라 검은색 배경과 혼합되어 어두워집니다.

**수정 제안:**
`clear` 메소드의 인자를 투명한 검은색으로 변경해야 합니다.

```python
# 수정 제안
self.fbo_a.clear(0.0, 0.0, 0.0, 0.0)
```

## 부차적 문제: UI와 렌더링 상태의 불일치

**위치:** `ContextUp/src/features/tools/noise_master/logic/renderer.py` 및 관련 UI 코드

**설명:**
`renderer.py`의 `_apply_layer` 메소드에는 `seamless` 파라미터가 `False`일 경우, `tile_count` 값을 코드가 내부적으로 1로 강제하는 로직이 있습니다.

```python
# logic/renderer.py -> _apply_layer 메소드
if not seamless:
    tile_count = 1
```

이는 렌더링 결과의 일관성을 위해 올바른 처리 방식입니다. 하지만 UI 상에서는 `seamless` 체크박스를 해제해도 `tile_count` 입력 필드의 값이 그대로 유지됩니다. 사용자는 자신이 설정한 타일링 값이 적용될 것으로 기대하지만, 실제 렌더링 결과물은 그렇지 않으므로 혼란을 유발할 수 있습니다.

**수정 제안:**
UI 코드에서 `seamless` 상태가 변경되는 시그널을 감지하여, `seamless`가 `False`일 때는 `tile_count` 입력 위젯을 비활성화(disable)하고 값을 시각적으로 1로 고정하는 로직을 추가하는 것을 권장합니다.

## 총평

Noise Master의 코드는 `moderngl`, `dataclasses` 등을 활용하여 유지보수하기 좋은 구조로 작성되었습니다. 발견된 주요 버그는 그래픽스 렌더링 파이프라인에 대한 이해 부족에서 비롯된 논리적 실수로 보이며, 제안된 수정안을 적용하면 기능이 정상적으로 작동할 것입니다. 부차적 문제인 UI 불일치 문제도 개선하면 더욱 완성도 높은 사용자 경험을 제공할 수 있을 것입니다.